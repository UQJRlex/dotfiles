#!/usr/bin/sh
# @author nate zhou
# @since 2025
# exec_always "~/.local/bin/swaymaxd"
# make sure only one placeholder window is spawned respectively in each mimic maximize workspace
# @depends `./swaymax`, `../../.config/sway/config`, jq, foot

output_count="$(swaymsg -t get_outputs -p | grep -c 'Output')"

if [ "$output_count" != 1 ]; then

    [ "$(swaymsg -t get_tree | jq -r '.. | select(.type? == "workspace" and .name == "-") | .nodes | length == 0')" = "false" ] || swaymsg  exec 'footclient -T "_placeholder_window1"'

    [ "$(swaymsg -t get_tree | jq -r '.. | select(.type? == "workspace" and .name == "=") | .nodes | length == 0')" = "false" ] || swaymsg  exec 'footclient -T "_placeholder_window2"'

else

    [ "$(swaymsg -t get_tree | jq -r '.. | select(.type? == "workspace" and .name == "=") | .nodes | length == 0')" = "false" ] || swaymsg  exec 'footclient -T "_placeholder_window2"'

fi
