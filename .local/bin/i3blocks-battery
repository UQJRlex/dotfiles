#!/usr/bin/sh
# @author nate zhou
# @since 2025

BAT="BAT1"
POWER="/sys/class/power_supply"

status="$(cat $POWER/$BAT/status)"
level="$(cat $POWER/$BAT/capacity)"
color="#ffffff"

case "$status" in
    "Discharging")
        [ "$level" -lt 20 ] && icon="" color="#888888" && break
        [ "$level" -ge 20 ] && icon="" && break
        [ "$level" -gt 40 ] && icon="" && break
        [ "$level" -gt 80 ] && icon="" && break
        ;;
    "Not charging")
        icon=""
        ;;
    "Charging")
        icon=""
        ;;
esac

case $BLOCK_BUTTON in
    1) notify-send -u low -r 3301 "$icon $(basename $0)" "$status ($level%)"
        ;;
    2) footclient -T "Floating Term" -H upower -i /org/freedesktop/UPower/devices/battery_$BAT
        ;;
    3) notify-send -u low -r 3301 -t 1100 "$icon $(basename $0)" "" && pkill +SIGRTMIN+12 i3blocks &
        ;;
esac

# ` `(U+2009) is the Thin Space
echo "$icon" "$level"%
echo

echo "$color"
