#!/usr/bin/env bash
# @author nate zhou
# @since 2025

WTTR_CACHE="$HOME/.cache/wttr"
update_time="$(stat -c "%Y" "$WTTR_CACHE")"
current_time="$(date +%s)"

result="$(sed 's/^.//; s/ // ; s/\+//' $WTTR_CACHE)"
color="#eeeeee"
icon="ó°…Ÿ"

case $BLOCK_BUTTON in
    1) notify-send -u low -r 3301 "$icon $(basename $0)" "$(cat $HOME/.cache/wttr)"
        ;;
    3) updw>/dev/null & # This script send signal 7 to update i3blocks module
esac

(( current_time - update_time > 86400 )) && result=""

echo "$icon""$result"
echo

[ -z "$result" ] && color="#888888"

echo "$color"
