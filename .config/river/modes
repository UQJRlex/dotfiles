#!/usr/bin/sh
# river/modes
# @author nate zhou
# @since 2025

mod=Mod1
mode_fcitx="[p]inyin [a]nthy"
mode_wmenu="[w[w]iki w[h]eart w[b]ook [a]mount [f]locks [p]off w[m]ulti w[s]ink w[j]doc w[e]moji"
mode_z="enable[t]ap disable[T]ap clip[h]ist-wipe [l]supdates d[w] w[c]al"
wlrctl="[hjkl]cursors [,]left [.]right [m]iddle"

riverctl declare-mode resize
riverctl map normal ${mod}+Control r enter-mode resize
riverctl map resize ${mod}+Control r enter-mode normal
riverctl map -repeat resize $mod r enter-mode normal
riverctl map -repeat resize None Escape enter-mode normal
riverctl map -repeat resize None space enter-mode normal
riverctl map -repeat resize None f toggle-float
riverctl map -repeat resize None h move left 50
riverctl map -repeat resize None j move down 50
riverctl map -repeat resize None k move up 50
riverctl map -repeat resize None l move right 50
riverctl map -repeat resize None y resize horizontal -50
riverctl map -repeat resize None u resize vertical 50
riverctl map -repeat resize None i resize vertical -50
riverctl map -repeat resize None o resize horizontal 50

riverctl declare-mode "$mode_fcitx"
riverctl map normal ${mod}+Control space enter-mode "$mode_fcitx"
riverctl map "$mode_fcitx" ${mod}+Control space enter-mode normal
riverctl map "$mode_fcitx" None Escape enter-mode normal
riverctl map "$mode_fcitx" None space enter-mode normal
riverctl map "$mode_fcitx" None p spawn "fcitx5-remote -s pinyin && riverctl enter-mode normal"
riverctl map "$mode_fcitx" None a spawn "fcitx5-remote -s anthy && riverctl enter-mode normal"

riverctl declare-mode "$mode_wmenu"
riverctl map normal $mod w enter-mode "$mode_wmenu"
riverctl map "$mode_wmenu" $mod w enter-mode normal
riverctl map "$mode_wmenu" None space enter-mode normal
riverctl map "$mode_wmenu" None Escape enter-mode normal
riverctl map "$mode_wmenu" None w spawn "riverctl enter-mode normal && $HOME/.local/bin/wwiki"
riverctl map "$mode_wmenu" None h spawn "riverctl enter-mode normal && $HOME/.local/bin/wheart"
riverctl map "$mode_wmenu" None b spawn "riverctl enter-mode normal && $HOME/.local/bin/wbook"
riverctl map "$mode_wmenu" None a spawn "riverctl enter-mode normal && $HOME/.local/bin/amount"
riverctl map "$mode_wmenu" None f spawn "riverctl enter-mode normal && $HOME/.local/bin/flocks"
riverctl map "$mode_wmenu" None p spawn "riverctl enter-mode normal && $HOME/.local/bin/poff"
riverctl map "$mode_wmenu" None m spawn "riverctl enter-mode normal && $HOME/.local/bin/wmulti"
riverctl map "$mode_wmenu" None s spawn "riverctl enter-mode normal && $HOME/.local/bin/wsink"
riverctl map "$mode_wmenu" None j spawn "riverctl enter-mode normal && $HOME/.local/bin/wjdoc"
riverctl map "$mode_wmenu" None e spawn "riverctl enter-mode normal && $HOME/.local/bin/wemoji"

riverctl declare-mode "$mode_z"
riverctl map normal $mod z enter-mode "$mode_z"
riverctl map "$mode_z" $mod z enter-mode normal
riverctl map "$mode_z" $mod apostrophe enter-mode normal
riverctl map "$mode_z" None space enter-mode normal
riverctl map "$mode_z" None Escape enter-mode normal
riverctl map "$mode_z" None h spawn "cliphist wipe && riverctl enter-mode normal"
riverctl map "$mode_z" None l spawn "$HOME/.local/bin/lsupdates && riverctl enter-mode normal"
riverctl map "$mode_z" None w spawn "$HOME/.local/bin/dw && riverctl enter-mode normal"
riverctl map "$mode_z" None c spawn "$HOME/.local/bin/wcal && riverctl enter-mode normal"



riverctl declare-mode "$wlrctl"
riverctl map normal $mod x enter-mode "$wlrctl"
riverctl map "$wlrctl" $mod     x       enter-mode normal
riverctl map "$wlrctl" None     space   enter-mode normal
riverctl map "$wlrctl" None     Escape  enter-mode normal
riverctl map -repeat "$wlrctl" None     h       spawn "wlrctl pointer move -90 0"
riverctl map -repeat "$wlrctl" None     j       spawn "wlrctl pointer move 0 90"
riverctl map -repeat "$wlrctl" None     k       spawn "wlrctl pointer move 0 -90"
riverctl map -repeat "$wlrctl" None     l       spawn "wlrctl pointer move 90 0"
riverctl map -repeat "$wlrctl" Shift    h       spawn "wlrctl pointer move -15 0"
riverctl map -repeat "$wlrctl" Shift    j       spawn "wlrctl pointer move 0 15"
riverctl map -repeat "$wlrctl" Shift    k       spawn "wlrctl pointer move 0 -15"
riverctl map -repeat "$wlrctl" Shift    l       spawn "wlrctl pointer move 15 0"

riverctl map -repeat "$wlrctl" None     comma   spawn "wlrctl pointer click left"
riverctl map -repeat "$wlrctl" None     period  spawn "wlrctl pointer click right"
riverctl map -repeat "$wlrctl" Shift    comma   spawn "wlrctl pointer click left"
riverctl map -repeat "$wlrctl" Shift    period  spawn "wlrctl pointer click right"

riverctl map -repeat "$wlrctl" None     n       spawn "wlrctl pointer scroll 30"
riverctl map -repeat "$wlrctl" None     p       spawn "wlrctl pointer scroll -30"
